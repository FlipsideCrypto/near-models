version: 2

models:
  - name: silver__staking_actions_s3
    description: |-
      This table records all the staking and delegation transactions occurring in NEAR. 

      Be aware, however, not all transactions here necessarily actually contribute to securing the NEAR network.
      Each epoch can have a different set of validators.
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - tx_hash

    columns:
      - name: tx_hash
        description: "{{ doc('tx_hash') }}"
        tests:
          - unique
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: block_timestamp
        description: "{{ doc('block_timestamp') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - TIMESTAMP_NTZ

      - name: pool_address
        description: "{{ doc('staking_pool_address') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: tx_signer
        description: "{{ doc('tx_signer') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: stake_amount
        description: "{{ doc('staking_stake_amount') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - NUMBER

      - name: action
        description: "{{ doc('staking_action') }}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - STRING
                - VARCHAR

      - name: _LOAD_TIMESTAMP
        description: "{{ doc('_load_timestamp')}}"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_in_type_list:
              column_type_list:
                - TIMESTAMP_NTZ
