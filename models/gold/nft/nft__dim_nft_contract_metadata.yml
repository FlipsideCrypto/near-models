version: 2

models:
  - name: nft__dim_nft_contract_metadata
    description: |-
      Comprehensive dimension table containing NEAR Protocol NFT contract metadata with detailed collection information and contract-level attributes. This model serves as the primary source of truth for NFT contract reference data in the gold layer, providing normalized access to collection names, symbols, base URIs, and contract configurations. The model transforms raw NFT contract metadata from silver__nft_contract_metadata into structured columns for efficient querying and analysis. It includes critical contract information such as collection names, token symbols, metadata URIs, contract icons, and token counts. This table is essential for NFT collection analytics, contract identification, metadata management, and collection discovery. The data flows from external NFT metadata APIs through silver__nft_contract_metadata, with contract-level attributes extracted to provide comprehensive collection context. This table supports understanding of NEAR ecosystem NFT diversity, collection characteristics, and contract standardization patterns.

    columns:
      - name: CONTRACT_ADDRESS
        description: "{{ doc('contract_address')}}"
        tests:
          - not_null

      - name: NAME
        description: "{{ doc('name')}}"
        tests:
          - not_null
          
      - name: SYMBOL
        description: "{{ doc('symbol')}}"

      - name: BASE_URI
        description: "{{ doc('base_uri')}}"

      - name: ICON
        description: "{{ doc('icon')}}"

      - name: TOKENS
        description: "{{ doc('tokens')}}"

      - name: DIM_NFT_CONTRACT_METADATA_ID
        description: "{{doc('id')}}"
        tests:
          - unique:
              where: inserted_timestamp >= SYSDATE() - INTERVAL '{{ var('DBT_TEST_LOOKBACK_DAYS', 14) }} days'
          - not_null:
              where: inserted_timestamp >= SYSDATE() - INTERVAL '{{ var('DBT_TEST_LOOKBACK_DAYS', 14) }} days'

      - name: INSERTED_TIMESTAMP
        description: "{{doc('inserted_timestamp')}}"

      - name: MODIFIED_TIMESTAMP
        description: "{{doc('modified_timestamp')}}"
