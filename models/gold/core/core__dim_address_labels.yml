version: 2

models:
  - name: core__dim_address_labels
    description: |-
      Comprehensive dimension table containing NEAR Protocol address labels and entity classification data for enhanced analytics and entity resolution. This model serves as the primary source of truth for address identification and categorization in the gold layer, providing normalized access to project names, entity types, and hierarchical label structures. The model transforms raw address label data from the silver layer into structured columns for efficient querying and analysis. It includes critical address information such as project associations, entity classifications, and multi-level label hierarchies. This table is essential for entity analytics, project tracking, whale identification, and ecosystem mapping. The data flows from external labeling services through silver__address_labels, with hierarchical classification applied to create structured entity relationships. This table supports understanding of NEAR ecosystem participants, project distribution, and entity behavior patterns.

    columns:
      - name: SYSTEM_CREATED_AT
        description: "{{ doc('system_created_at')}}"

      - name: BLOCKCHAIN
        description: "{{ doc('symbol')}}"

      - name: ADDRESS
        description: "{{ doc('address')}}"

      - name: ADDRESS_NAME
        description: "{{ doc('address_name')}}"

      - name: PROJECT_NAME
        description: "{{ doc('project_name')}}"

      - name: LABEL_TYPE
        description: "{{ doc('label_type')}}"

      - name: LABEL_SUBTYPE
        description: "{{ doc('label_subtype')}}"

      - name: L1_LABEL
        description: "{{ doc('l1_label')}}"

      - name: L2_LABEL
        description: "{{ doc('l2_label')}}"

      - name: DIM_ADDRESS_LABELS_ID
        description: "{{doc('id')}}"
        tests:
          - not_null
          - unique:
              where: inserted_timestamp >= SYSDATE() - INTERVAL '{{ var('DBT_TEST_LOOKBACK_DAYS', 14) }} days'

      - name: INSERTED_TIMESTAMP
        description: "{{doc('inserted_timestamp')}}"

      - name: MODIFIED_TIMESTAMP
        description: "{{doc('modified_timestamp')}}"
